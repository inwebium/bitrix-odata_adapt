{"version":3,"sources":["webpack:///./src/app/constants/content-types.ts","webpack:///./src/app/mediagallery/components/mediagallery-page/mediagallery-page.component.html","webpack:///./src/app/mediagallery/components/mediagallery-page/mediagallery-page.component.scss","webpack:///./src/app/mediagallery/components/mediagallery-page/mediagallery-page.component.ts","webpack:///./src/app/mediagallery/mediagallery-routing.module.ts","webpack:///./src/app/mediagallery/mediagallery.module.ts","webpack:///./src/app/services/photo-library/photo-library.service.ts","webpack:///./src/app/services/videos/videos.service.ts"],"names":[],"mappings":"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","file":"mediagallery-mediagallery-module.js","sourcesContent":["export const contentTypes = {\n  album: 'Контентный тип альбома изображений',\n  photo: 'Контентный тип фото'\n};\n","module.exports = \"<div class=\\\"l-page-header\\\">\\n  <div class=\\\"l-breadcrumbs\\\">\\n    <div class=\\\"l-breadcrumb\\\"><a [routerLink]=\\\"companyId ? ['/enterprise/' + companyId] : ['/']\\\">Главная</a></div>\\n    <div class=\\\"l-breadcrumb\\\">Медиагалерея</div>\\n  </div>\\n  <div class=\\\"title\\\">\\n    Медиагалерея\\n  </div>\\n</div>\\n<div class=\\\"l-page\\\">\\n  <div class=\\\"l-page-inner\\\">\\n    <div class=\\\"l-page__content\\\">\\n      <div class=\\\"l-mediagallery\\\">\\n        <a [routerLink]=\\\"['photo']\\\" class=\\\"photogallery-card\\\" [ngStyle]=\\\"{ 'background-image': 'url(' + prepareLink(photoUrl) + ')' }\\\">\\n          <div class=\\\"gradient\\\"></div>\\n          <div class=\\\"content\\\">\\n            <div class=\\\"title\\\">\\n              Фотогалерея\\n            </div>\\n            <div class=\\\"items-counter\\\">\\n              <ng-container *ngIf=\\\"albumsTotal > 0\\\">\\n                {{albumsTotal}} {{getEnding(albumsTotal, ['альбом', 'альбома', 'альбомов'])}}\\n              </ng-container>\\n              <ng-container *ngIf=\\\"albumsTotal === 0\\\">\\n                Нет альбомов\\n              </ng-container>\\n            </div>\\n          </div>\\n        </a>\\n        <a [routerLink]=\\\"['video', 'search']\\\" class=\\\"videogallery-card\\\">\\n          <ng-container *ngIf=\\\"video && video.isIFrame\\\">\\n            <iframe [src]=\\\"video.videoUrl | iframeVideo\\\"></iframe>\\n          </ng-container>\\n          <ng-container *ngIf=\\\"video && !video.isIFrame\\\">\\n            <video src=\\\"{{video.videoUrl}}\\\"></video>\\n          </ng-container>\\n          <div class=\\\"gradient\\\"></div>\\n          <div class=\\\"content\\\">\\n            <div class=\\\"title\\\">\\n              Видеогалерея\\n            </div>\\n            <div class=\\\"items-counter\\\">\\n              <ng-container *ngIf=\\\"albumsTotal > 0\\\">\\n                {{videosTotal}} видео\\n              </ng-container>\\n              <ng-container *ngIf=\\\"albumsTotal === 0\\\">\\n                Нет видео\\n              </ng-container>\\n            </div>\\n          </div>\\n        </a>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\"","module.exports = \"#s4-bodyContainer {\\n  padding: 0; }\\n\\n@-webkit-keyframes shine-avatar {\\n  0% {\\n    background-position: -30px; }\\n  40%,\\n  100% {\\n    background-position: 210px; } }\\n\\n@keyframes shine-avatar {\\n  0% {\\n    background-position: -30px; }\\n  40%,\\n  100% {\\n    background-position: 210px; } }\\n\\n.l-page-header {\\n  padding-bottom: 40px; }\\n\\n.l-mediagallery {\\n  width: 90%;\\n  padding-left: 25px; }\\n\\n.l-mediagallery .photogallery-card,\\n  .l-mediagallery .videogallery-card {\\n    position: relative;\\n    display: inline-block;\\n    width: 49%;\\n    background-repeat: no-repeat;\\n    background-size: cover;\\n    background-position: center; }\\n\\n.l-mediagallery .photogallery-card video, .l-mediagallery .photogallery-card iframe,\\n    .l-mediagallery .videogallery-card video,\\n    .l-mediagallery .videogallery-card iframe {\\n      position: absolute;\\n      top: 0;\\n      width: 100%;\\n      height: 100%; }\\n\\n.l-mediagallery .photogallery-card:before,\\n    .l-mediagallery .videogallery-card:before {\\n      display: block;\\n      content: \\\" \\\";\\n      width: 100%;\\n      padding-bottom: 60.60606061%; }\\n\\n.l-mediagallery .photogallery-card > .content,\\n    .l-mediagallery .videogallery-card > .content {\\n      position: absolute;\\n      top: 0;\\n      left: 0;\\n      right: 0;\\n      bottom: 0; }\\n\\n.l-mediagallery .photogallery-card .content,\\n    .l-mediagallery .videogallery-card .content {\\n      padding: 30px 40px;\\n      box-sizing: border-box;\\n      background-repeat: no-repeat;\\n      background-size: 30% 30%;\\n      background-position: center; }\\n\\n.l-mediagallery .photogallery-card .gradient,\\n    .l-mediagallery .videogallery-card .gradient {\\n      position: absolute;\\n      left: 0;\\n      top: 0;\\n      width: 100%;\\n      height: 100%;\\n      background: linear-gradient(to bottom, rgba(5, 5, 5, 0.7), rgba(88, 88, 88, 0)); }\\n\\n.l-mediagallery .photogallery-card .title,\\n    .l-mediagallery .videogallery-card .title {\\n      color: #FFFFFF;\\n      font-size: 34px;\\n      font-weight: bold;\\n      margin-bottom: 7px; }\\n\\n.l-mediagallery .photogallery-card .items-counter,\\n    .l-mediagallery .videogallery-card .items-counter {\\n      color: #FFFFFF;\\n      font-size: 22px; }\\n\\n.l-mediagallery .photogallery-card {\\n    margin-right: 2%; }\\n\\n.l-mediagallery .photogallery-card .content {\\n      background-image: url(/assets/icons/icon-photo.svg); }\\n\\n.l-mediagallery .videogallery-card .content {\\n    background-image: url(/assets/icons/icon-play.svg); }\\n\"","import { ActivatedRoute } from '@angular/router';\nimport { Subscription } from 'rxjs';\nimport { Component, OnInit } from '@angular/core';\n\nimport { Video } from 'src/app/services/videos/video';\nimport { PhotoLibraryService } from 'src/app/services/photo-library/photo-library.service';\nimport { ImagesService } from 'src/app/services/images/images.service';\nimport { VideosService } from 'src/app/services/videos/videos.service';\nimport { contentTypes } from 'src/app/constants/content-types';\n\n@Component({\n  selector: 'app-mediagallery-page',\n  templateUrl: './mediagallery-page.component.html',\n  styleUrls: ['./mediagallery-page.component.scss']\n})\nexport class MediagalleryPageComponent implements OnInit {\n\n  public albumsTotal: number = null;\n  public videosTotal: number = null;\n  public photoUrl: string = null;\n  public video: Video = null;\n  public webId: string = null;\n  public subscription: Subscription = null;\n  public companyId: number = null;\n\n  constructor(\n    private photoLibraryService: PhotoLibraryService,\n    private imagesService: ImagesService,\n    private videosService: VideosService,\n    private route: ActivatedRoute\n  ) {}\n\n  ngOnInit() {\n    this.subscription = this.route.params.subscribe(params => {\n      if (params.webId) {\n        this.webId = params.webId;\n      }\n      if (params.id) {\n        this.companyId = params.id;\n      }\n    });\n    this.photoLibraryService.getItems({ filter: `ContentType eq '${encodeURI(contentTypes.album)}'`, top: 5000, webId: this.webId })\n      .subscribe((items: any[]) => this.albumsTotal = items.length);\n    this.photoLibraryService.getRandomItems({top: 1, filter: `ContentType eq '${encodeURI(contentTypes.photo)}'`,  webId: this.webId })\n      .subscribe(photos => {\n        if (photos.length > 0) {\n          this.photoUrl = photos[0].url;\n        }\n      });\n    this.videosService.getItems({ webId: this.webId }).subscribe((items: any[]) => {\n      this.videosTotal = items.length;\n      if (items.length > 0) {\n        const i = Math.floor(Math.random() * items.length);\n        this.video = items[i];\n      }\n    });\n  }\n\n  getEnding(number: number, endings: string[]) {\n    let ending: string;\n    number = number % 100;\n    if (number >= 11 && number <= 19) {\n      ending = endings[2];\n    } else {\n      const i = number % 10;\n      switch (i) {\n        case (1): ending = endings[0]; break;\n        case (2):\n        case (3):\n        case (4): ending = endings[1]; break;\n        default: ending = endings[2];\n      }\n    }\n    return ending;\n  }\n\n  public prepareLink(link: string) {\n    return this.imagesService.prepareBackgroundUrl(link);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { MediagalleryPageComponent } from './components/mediagallery-page/mediagallery-page.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: MediagalleryPageComponent,\n    data: { animation: 'fadeAnimation', title: 'Медиагалерея' }\n  },\n  {\n    path: 'photo',\n    loadChildren: '../photogallery/photogallery.module#PhotogalleryModule'\n  },\n  {\n    path: 'video',\n    loadChildren: '../videogallery/videogallery.module#VideogalleryModule'\n  }\n];\n\n@NgModule({\n    imports: [RouterModule.forChild(routes)],\n    exports: [RouterModule]\n})\nexport class MediagalleryRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\n\nimport { MediagalleryPageComponent } from './components/mediagallery-page/mediagallery-page.component';\nimport { MediagalleryRoutingModule } from './mediagallery-routing.module';\nimport { SharedModule } from '../shared/shared.module';\n\n\n@NgModule({\n  declarations: [\n    MediagalleryPageComponent\n  ],\n  imports: [\n    CommonModule,\n    MediagalleryRoutingModule,\n    SharedModule,\n    FormsModule,\n    RouterModule\n  ]\n})\nexport class MediagalleryModule { }\n","import { Injectable } from '@angular/core';\nimport { ICachingOptions } from '@pnp/odata';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { Web } from '@pnp/sp';\nimport { flatMap, map } from 'rxjs/operators';\nimport * as moment from 'moment';\n\nimport { SharepointService } from '../sharepoint/sharepoint.service';\nimport { ListItemsService } from '../list-items-service';\nimport { PhotoLibrary } from './photo-library';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PhotoLibraryService extends ListItemsService<PhotoLibrary>  {\n\n  constructor(private http: HttpClient,\n    private sharepointService: SharepointService) {\n    super();\n  }\n\n  getCachingOptions(): ICachingOptions {\n    return {\n      expiration: moment().add(30, 'minutes').toDate(),\n      key: this.getListTitle(),\n      storeName: 'session'\n    };\n  }\n\n  getListTitle(): string {\n    return 'Библиотека фотогалереи';\n  }\n\n  getListRelativePath(): string {\n    return 'slPhotoLibrary';\n  }\n\n  getSelect(): string {\n    return 'Id,Title,slAlbumCover,slAlbumDescription,slAlbumIndex,slPhotoIndex,File/ServerRelativeUrl,ContentType,ContentTypeId,Created';\n  }\n\n  getExpand(): string {\n    return 'File';\n  }\n\n  getOrderBy(): [string, boolean][] {\n    return [['Created', false]];\n  }\n\n  getTop(): number {\n    return 15;\n  }\n\n  convertListItemToEntity(item: any): PhotoLibrary {\n    const entity: PhotoLibrary = {\n      id: item.Id,\n      title: item.Title,\n      albumCover: item.slAlbumCover,\n      albumDescription: item.slAlbumDescription,\n      albumIndex: item.slAlbumIndex,\n      photoIndex: item.slPhotoIndex,\n      url: item.File && item.File.ServerRelativeUrl\n    };\n    return entity;\n  }\n\n  convertEntityToListItem(entity: PhotoLibrary) {\n    throw new Error('Method not implemented.');\n  }\n\n  getMockItems(): PhotoLibrary[] {\n    return [];\n  }\n\n  isMock(): boolean {\n    return false;\n  }\n\n  getFiles(id: number, webId?: string): Observable<PhotoLibrary[]> {\n    return this.getWebById(webId).pipe(\n        map((web: Web) => web.lists.getByTitle(this.getListTitle()).items.getById(id).folder.files.toUrlAndQuery()),\n        // flatMap((url: string) => this.http.get(`${this.sharepointService.getRelativeUrl()}/${url}?$expand=ListItemAllFields`)),\n        flatMap((url: string) => url.indexOf('://') > 0 ? this.http.get(`${url}?$expand=ListItemAllFields`)\n          : this.http.get(`${this.sharepointService.getRelativeUrl()}/${url}?$expand=ListItemAllFields`)),\n        map((item: any) => item.value.map(i => {\n          const entity = this.convertListItemToEntity(i.ListItemAllFields);\n          entity.url = i.ServerRelativeUrl;\n          return entity;\n        })));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ICachingOptions } from '@pnp/odata';\nimport * as moment from 'moment';\n\nimport { Video } from './video';\nimport { ListItemsService } from '../list-items-service';\nimport { SharepointService } from '../sharepoint/sharepoint.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class VideosService extends ListItemsService<Video> {\n\n  getListTitle(): string {\n    return 'Ссылки на видео';\n  }\n\n  getListRelativePath(): string {\n    return 'lists/slVideo';\n  }\n\n  getSelect(): string {\n    return 'Id,Title,slVideoUrl,slIsIFrame,Created';\n  }\n\n  getExpand(): string {\n    return null;\n  }\n\n  getOrderBy(): [string, boolean][] {\n    return [['Created', false]];\n  }\n\n  getTop(): number {\n    return 5000;\n  }\n\n  getCachingOptions(): ICachingOptions {\n    return {\n      expiration: moment().add(30, 'minutes').toDate(),\n      key: this.getListTitle(),\n      storeName: 'session'\n    };\n  }\n\n  convertListItemToEntity(item: any): Video {\n    const entity: Video = {\n      id: item.Id,\n      title: item.Title,\n      isIFrame: item.slIsIFrame,\n      videoUrl: item.slVideoUrl,\n      created: new Date(item.Created),\n      createdTitle: moment(item.Created).fromNow()\n    };\n    return entity;\n  }\n\n  convertEntityToListItem(entity: Video) {\n    throw new Error('Method not implemented.');\n  }\n\n  getMockItems(): Video[] {\n    return [];\n  }\n\n  isMock(): boolean {\n    return false;\n  }\n\n}\n"],"sourceRoot":""}